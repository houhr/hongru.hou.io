---
layout: post
title: How to communicate between Arduino and Chrome
published: true
---
## Step 1: set up Arduino

First things first. We need prepare input data before we can manipulate them. I used an Arduino Uno, a breadboard and a [circular soft potentiometer](https://www.adafruit.com/products/1069) to generate analog data. We need connect the middle pin of the potentiometer to <code>A0</code>, and another two pins to <code>5V</code> and <code>GND</code>. Then, upload the “AnalogReadSerial” program from Arduino -> File -> Examples -> Basics -> AnalogReadSerial to Arduino. After that, open the Serial Monitor to make sure you can see the changing numbers when you move your finger on the potentiometer, then remember to *close the Serial Monitor*.

## Step 2: set up middleman

PS: This part is basically an abstract of [LAB: SERIAL COMMUNICATION WITH NODE.JS](https://itp.nyu.edu/physcomp/labs/labs-serial-communication/lab-serial-communication-with-node-js/), and you can find more detail information there.

In order to let Arduino talk to Chrome, we need a middleman to pass data. And the middleman here is a small Node application. If you don't have Node installed in your computer, you can instll it from [here](http://www.nodejs.org/). Then, go to a dedicated folder and type following commands in your favorite terminal tool to install these two libraries:

    $ npm install serialport
    $ npm install servi

### Find the right serial port

Save following code to a file named <kbd>serialports.js</kbd>.

{% gist 88ff946bfd94fb1a6bab %}

Keep your Arduino connected and run:

    $ node serialports.js

Then, you should see a list of your computer's serial ports like this:

<p><img src="/images/compressed/blog/2015-2-7/1.png" title="List of computer's serial ports"></p>

Find the line which starts with <code>/dev/cu.usbmodem</code> and copy the whole line to a place, we'll use it later.

### Connect to the right serial port and show data

Save following codes in <kbd>index.js</kbd>, and replace the third line's string with the one you just saved:

{% gist 378085abfd8f1dbec43c %}

Then, run this file and you will see a series of numbers which generated by Arduino in the terminal.

### Set up a Web server

Add following codes to the end of the index.js:

{% gist aec37d5e8b948baeaad9 %}

Then open <kbd>http://localhost:8080/data/</kbd> in the browser, you will see one of the data number in the page.

## Step 3: set up Chrome

Create a folder named <kbd>public</kbd>, and then create a <kbd>index.html</kbd> file as following:

{% gist 5dbc66522c7a6d33e919 %}

Now, if you open <kbd>http://localhost:8080/</kbd>, you will find you can control the color of the background by touching the potentiometer.
